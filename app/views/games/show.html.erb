<%= render partial: 'max_rank/form' %>

<% @max_ranks_array.each do |max_rank| %>
  <p>
    <div>
      Rank Type: <%= max_rank[:max_rank].rank_type.name %>
    </div>
    <div>
      Value: <%= max_rank[:max_rank].value %>
    </div>
    <div>
      Source: <%= max_rank[:max_rank].source %>
    </div>
    <div class="upvote" data-max-rank-id=" <%= max_rank[:max_rank].id %>">
      upvote (<%= max_rank[:upvotes] %>)
    </div>
    <div class="downvote" data-max-rank-id=" <%= max_rank[:max_rank].id %>">
      downvote (<%= max_rank[:downvotes] %>)
    </div>
  </p>
<% end %>

<script>
$(function() {
  $('.upvote').click(function() {
    var maxRankId = $(this).data('max-rank-id')
    $.ajax({
      type : 'POST',
      url : '/votes/new',
      data : {
        vote: {
          max_rank_id : maxRankId,
          vote: 1
        }
      }
    }).done(function(msg) {});
  });
   $('.downvote').click(function() {
    var maxRankId = $(this).data('max-rank-id')
    $.ajax({
      type : 'POST',
      url : '/votes/new',
      data : {
        vote: {
          max_rank_id : maxRankId,
          vote: -1
        }
      }
    }).done(function(msg) {});
  });
  
});
</script>

